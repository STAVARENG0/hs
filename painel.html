<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Painel HS Nutrition</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<style>
    :root {
      --black: #0d0d0d;
      --white: #ffffff;
      --orange: #ff3c00;
      --card: #1a1a1a;
      --dark: #0f1a1c;
      --green: #28a745;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Poppins', sans-serif; }
    body { background: var(--black); color: var(--white); padding: 20px; }
    h1 { text-align: center; margin-bottom: 20px; color: var(--orange); }
    .container { display: flex; gap: 20px; max-width: 1200px; margin: 0 auto; }
    .form-section, .list-section {
      flex: 1; background: var(--card); padding: 20px; border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    }
    .form { display: flex; flex-direction: column; gap: 12px; }
    input, textarea, select {
      padding: 12px; border-radius: 8px; border: none; font-size: 14px;
    }
    textarea { min-height: 80px; resize: vertical; }
    .upload-btn {
      display: inline-block; padding: 12px; border-radius: 8px;
      background: var(--orange); color: var(--white); text-align: center;
      font-weight: 600; cursor: pointer; transition: 0.2s;
    }
    .upload-btn:hover { filter: brightness(1.1); }
    #fotos { display: none; }
    button {
      background: var(--orange); border: none; padding: 12px 16px;
      border-radius: 8px; cursor: pointer; color: var(--white);
      font-weight: 600; transition: 0.2s; font-size: 15px;
    }
    button:hover { filter: brightness(1.1); }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    table th, table td { border: 1px solid #333; padding: 8px; text-align: left; }
    table th { background: #222; }

    .preview-container { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
    .preview { position: relative; }
    .preview img { width: 80px; height: 80px; object-fit: cover; border-radius: 6px; border: 2px solid transparent; }
    .preview input[type="radio"] { position: absolute; top: 4px; left: 4px; transform: scale(1.2); }

    .alert { margin-top: 10px; padding: 10px; border-radius: 6px; text-align: center; display: none; }
    .alert.success { background: var(--green); color: white; }
  
.config-btn {
  display:block;
  margin:0 auto 20px;
  background:#ff3c00; border:none; color:#fff;
  padding:8px 16px; border-radius:8px;
  font-size:14px; font-weight:600; cursor:pointer;
}
.config-btn:hover { filter:brightness(1.1); }
.modal{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); justify-content:center; align-items:center; z-index:3000;}
.modal.show{display:flex !important;}
.modal-content{background:#1a1a1a; padding:20px; border-radius:12px; max-width:400px; width:90%; color:#fff; position:relative;}


.action-buttons { display:flex; gap:6px; }
.action-buttons button { flex:1; }

/* === Edit Modal: responsivo e sem scroll vis√≠vel === */
#editModal { overflow: hidden; }
body.modal-open { overflow: hidden; }

#editModal .modal-content {
  width: min(680px, 92vw);
  max-height: min(88vh, 900px);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

#editModal .form {
  flex: 1;
  overflow: auto;
  padding-right: 8px;
}

/* Ocultar barras de rolagem (Chrome/Safari/Edge/Firefox/IE) */
#editModal .form::-webkit-scrollbar { width: 0; height: 0; }
#editModal .form { scrollbar-width: none; -ms-overflow-style: none; }
</style>
</head>
<body>
<h1>Painel HS Nutrition</h1>
<button class="config-btn" id="openGithubModal">Configura√ß√µes</button>
<div class="container">
<div class="form-section">
<form class="form" id="formProduto">
<input id="titulo" placeholder="T√≠tulo do produto" required type="text"/>
<input id="valor" placeholder="Valor (‚Ç¨)" required step="0.01" type="number"/>
<textarea id="descricao" placeholder="Descri√ß√£o do produto"></textarea>
<label>Departamento</label>
<select id="departamento" required>
  <option value="">Selecione...</option>
  <option value="supplements">Supplements</option>
  <option value="cosmetics">Cosmetics</option>
</select>
<label>Categoria</label>
<select id="subcategoria" required>
  <option value="">Selecione um departamento primeiro...</option>
</select>
<label>Estoque</label>
<input id="estoque" min="0" placeholder="Quantidade em estoque" type="number" value="0"/>
<label class="upload-btn" for="fotos">üì∑ Adicionar Imagens</label>
<input accept="image/*" id="fotos" multiple type="file"/>
<div class="preview-container" id="preview"></div>
<button type="submit">Adicionar Produto</button>
<div class="alert success" id="alertBox">‚úÖ Produto salvo com sucesso no GitHub!</div>
</form>
</div>
<div class="list-section">
<h2>Produtos Cadastrados</h2>
<table>
<thead>
<tr>
<th>T√≠tulo</th>
<th>Valor (‚Ç¨)</th>
<th>Departamento</th><th>Categoria</th>
<th>Estoque</th>
<th>Data</th>
<th>A√ß√µes</th>
</tr>
</thead>
<tbody id="listaProdutos"></tbody>
</table>
</div>
</div>
<script>

// ==== Categorias (subcategorias) por departamento ====
const SUPP_CATS = [
  "Vitamins & Minerals",
  "Heart Health",
  "Liver Support",
  "Multivitamins",
  "Mass Gainer",
  "Pre-Workout",
  "BCAA & EAA",
  "Probiotics",
  "Glutamine",
  "Collagen",
  "Diuretics",
  "Omega 3",
  "Creatine",
  "Fat Loss",
];

const COSM_CATS = [
  "Body Oil",
  "Nails",
  "Perfume",
  "Mascara",
  "Skin Care",
  "Soap",
  "Moisturizer",
  "Body Splash",
  "Hair Tonic",
  "Leave-in Cream",
  "Shampoo & Conditioner",
];

function fillOptions(selectEl, arr, selected){
  selectEl.innerHTML = '<option value="">Selecione...</option>';
  arr.forEach(n => {
    const opt = document.createElement('option');
    opt.value = n;
    opt.textContent = n;
    if(selected && selected === n) opt.selected = true;
    selectEl.appendChild(opt);
  });
}

function onDepartamentoChange(){
  const dep = document.getElementById('departamento').value;
  const sub = document.getElementById('subcategoria');
  if(dep === 'supplements') fillOptions(sub, SUPP_CATS);
  else if(dep === 'cosmetics') fillOptions(sub, COSM_CATS);
  else sub.innerHTML = '<option value="">Selecione um departamento primeiro...</option>';
}

function onEditDepartamentoChange(){
  const dep = document.getElementById('editDepartamento').value;
  const sub = document.getElementById('editSubcategoria');
  if(dep === 'supplements') fillOptions(sub, SUPP_CATS, document.getElementById('editSubcategoria').dataset.value || '');
  else if(dep === 'cosmetics') fillOptions(sub, COSM_CATS, document.getElementById('editSubcategoria').dataset.value || '');
  else sub.innerHTML = '<option value="">Selecione um departamento primeiro...</option>';
}

// Vincular listeners ap√≥s DOM pronto
document.addEventListener('DOMContentLoaded', () => {
  const dep = document.getElementById('departamento');
  if(dep){ dep.addEventListener('change', onDepartamentoChange); }
  const ed = document.getElementById('editDepartamento');
  if(ed){ ed.addEventListener('change', onEditDepartamentoChange); }
});

    let produtos = [];

    // ===== Helpers UTF-8/Base64 seguros =====
    function decodeBase64Utf8(b64){
      try{
        b64 = (b64 || '').replace(/\\n/g,'');
        if('TextDecoder' in window){
          const bin = atob(b64);
          const bytes = new Uint8Array(bin.length);
          for(let i=0;i<bin.length;i++) bytes[i] = bin.charCodeAt(i);
          return new TextDecoder().decode(bytes);
        }
        // fallback
        return decodeURIComponent(escape(atob(b64)));
      }catch(e){ console.error('decodeBase64Utf8 error', e); return atob(b64 || ''); }
    }
    function encodeBase64Utf8(str){
      try{
        if('TextEncoder' in window){
          const bytes = new TextEncoder().encode(str);
          let bin = '';
          bytes.forEach(b => bin += String.fromCharCode(b));
          return btoa(bin);
        }
        // fallback
        return btoa(unescape(encodeURIComponent(str)));
      }catch(e){ console.error('encodeBase64Utf8 error', e); return btoa(str || ''); }
    }

    document.getElementById('fotos').addEventListener('change', (e) => {
      const files = Array.from(e.target.files);
      const preview = document.getElementById('preview');
      preview.innerHTML = '';
      files.forEach((f, i) => {
        const url = URL.createObjectURL(f);
        const div = document.createElement('div');
        div.className = 'preview';
        div.innerHTML = `<input type="radio" name="capa" ${i===0? 'checked' : ''} value="${i}"><img src="${url}">`
        preview.appendChild(div);
      });
    });

    function renderProdutos() {
      const lista = document.getElementById('listaProdutos');
      lista.innerHTML = '';
      produtos.forEach((p, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${p.title}</td>
          <td>‚Ç¨ ${Number(p.price || 0).toFixed(2)}</td>
          <td>${p.department || (p.category === 'supplements' || p.category === 'cosmetics' ? p.category : '')}</td><td>${p.category}</td>
          <td>${p.stock}</td>
          <td>${new Date(p.createdAt).toLocaleDateString()}</td>
          <td><div class='action-buttons'><button onclick="editarProduto(${i})">Editar</button><button onclick="excluirProduto(${i})">Excluir</button></div></td>
        `;
        lista.appendChild(tr);
      });
    }

    async function carregarProdutosGitHub(){
      const cfg = JSON.parse(localStorage.getItem('ghConfig')||'{}');
      if(!cfg.repo || !cfg.branch || !cfg.path || !cfg.token) return;
      try {
        const res = await fetch(`https://api.github.com/repos/${cfg.repo}/contents/${cfg.path}?ref=${cfg.branch}`, {
          headers: { Authorization: `token ${cfg.token}` }
        });
        if(res.ok){
          const data = await res.json();
          const raw = decodeBase64Utf8(data.content || '');
          produtos = JSON.parse(raw || '[]');
          renderProdutos();
        }
      } catch(e){
        console.error("Erro ao carregar produtos:", e);
      }
    }

    async function salvarNoGitHub(produtosNovos){
      const cfg = JSON.parse(localStorage.getItem('ghConfig')||'{}');
      if(!cfg.repo || !cfg.branch || !cfg.path || !cfg.token){
        alert("Configura√ß√£o GitHub incompleta!");
        return;
      }
      const url = `https://api.github.com/repos/${cfg.repo}/contents/${cfg.path}`;
      let sha = null;

      try {
        const res = await fetch(url+`?ref=${cfg.branch}`, {
          headers: {
            "Authorization": `token ${cfg.token}`,
            "Accept": "application/vnd.github+json"
          }
        });
        if(res.ok){
          const data = await res.json();
          sha = data.sha; // s√≥ ter√° valor se o arquivo existir
        }
      } catch(e){ console.error("Erro ao buscar SHA:", e); }

      // Sanitiza√ß√£o e normaliza√ß√£o PARA SALVAR (sem quebrar acentua√ß√£o)
      produtosNovos = (produtosNovos || []).map(p => ({
        ...p,
        title: p.title ?? 'Sem t√≠tulo',
        description: p.description ?? '',
        department: p.department || 'supplements',
        category: p.category || 'uncategorized',
        price: Number(p.price || 0),
        stock: Number.isFinite(p.stock) ? p.stock : parseInt(p.stock || '0', 10),
        gallery: (Array.isArray(p.gallery) ? p.gallery.filter(Boolean) : (p.gallery ? [p.gallery] : [])).filter(u => u && u !== p.image).filter((u, idx, arr) => arr.indexOf(u) === idx),
        image: p.image || '',
        createdAt: p.createdAt || Date.now(),
        status: p.status || 'publicado'
      }));

      const novoConteudo = encodeBase64Utf8(JSON.stringify(produtosNovos, null, 2));
      const body = {
        message: "Atualizando products.json via painel",
        branch: cfg.branch,
        content: novoConteudo,
      };
      if(sha) body.sha = sha; // envia sha apenas se existir

      const putRes = await fetch(url, {
        method: "PUT",
        headers: {
          "Authorization": `token ${cfg.token}`,
          "Accept": "application/vnd.github+json",
          "Content-Type": "application/json"
        },
        body: JSON.stringify(body)
      });

      if(putRes.ok){
        document.getElementById("alertBox").innerHTML = "‚úÖ Produto atualizado com sucesso no GitHub!";
        document.getElementById("alertBox").classList.add("success");
        document.getElementById("alertBox").style.display = "block";
        setTimeout(()=> document.getElementById("alertBox").style.display="none", 3000);
        try { await carregarProdutosGitHub(); } catch(_) {}
      } else {
        const txt = await putRes.text().catch(()=> "");
        alert("Erro ao salvar no GitHub: " + putRes.status + (txt ? "\n" + txt : ""));
      }
    }

    async function uploadImagens(produtoId, files){
      const cfg = JSON.parse(localStorage.getItem('ghConfig')||'{}');
      const uploadedLinks = [];
      for(let i=0; i<files.length; i++){
        const file = files[i];
        const reader = new FileReader();
        const base64 = await new Promise(res=>{
          reader.onload = () => res(reader.result.split(",")[1]);
          reader.readAsDataURL(file);
        });

        const imgPath = `products/${produtoId}/${file.name}`;
        const url = `https://api.github.com/repos/${cfg.repo}/contents/${imgPath}`;
        await fetch(url, {
          method: "PUT",
          headers: { "Authorization": `token ${cfg.token}`, "Content-Type": "application/json" },
          body: JSON.stringify({
            message: `Adicionando imagem ${file.name} do produto ${produtoId}`,
            branch: cfg.branch,
            content: base64
          })
        });

        uploadedLinks.push(`https://raw.githubusercontent.com/${cfg.repo}/${cfg.branch}/${imgPath}`);
      }
      return uploadedLinks;
    }

    document.getElementById('formProduto').addEventListener('submit', async (e) => {
      e.preventDefault();
      const titulo = document.getElementById('titulo').value;
      const valor = Number(document.getElementById('valor').value || 0);
      const descricao = document.getElementById('descricao').value;
      const departamento = document.getElementById('departamento').value;
      const categoria = document.getElementById('subcategoria').value;
      const estoque = parseInt(document.getElementById('estoque').value || '0', 10);

      const fotosInput = document.getElementById('fotos');
      const produtoId = Date.now().toString();
      const fotos = fotosInput.files;
      const capaIndex = parseInt(document.querySelector('input[name="capa"]:checked')?.value || 0);
      const uploaded = await uploadImagens(produtoId, fotos);

      const cover = uploaded[capaIndex] || "";
      const galleryClean = (uploaded || [])
        .filter(Boolean)
        .filter((u, i) => i !== capaIndex) // remove capa
        .filter((u, idx, arr) => arr.indexOf(u) === idx); // √∫nicos
      const produto = {
        id: produtoId,
        title: titulo,
        price: valor,
        description: descricao,
        department: departamento,
        category: categoria,
        stock: estoque,
        image: cover,
        gallery: galleryClean,
        createdAt: Date.now(),
        status: "publicado"
      };

      produtos.push(produto);
      await salvarNoGitHub(produtos);
      document.getElementById('formProduto').reset();
      document.getElementById('preview').innerHTML = '';
      renderProdutos();
    });
  
    async function excluirProduto(index){
      const cfg = JSON.parse(localStorage.getItem('ghConfig')||'{}');
      const produto = produtos[index];
      if(!produto) return;
      // Remover imagens do GitHub (best-effort)
      for(let url of produto.gallery || []){
        try{
          const path = url.split(cfg.repo + '/' + cfg.branch + '/')[1];
          if(path){
            const apiUrl = `https://api.github.com/repos/${cfg.repo}/contents/${path}`;
            const res = await fetch(apiUrl+`?ref=${cfg.branch}`, { headers: { Authorization: `token ${cfg.token}` } });
            if(res.ok){
              const data = await res.json();
              await fetch(apiUrl, {
                method: "DELETE",
                headers: { "Authorization": `token ${cfg.token}`, "Content-Type": "application/json" },
                body: JSON.stringify({ message: "Removendo imagem do produto", branch: cfg.branch, sha: data.sha })
              });
            }
          }
        }catch(e){ console.error("Erro removendo imagem:", e); }
      }
      // Remover do array e salvar no GitHub
      produtos.splice(index,1);
      await salvarNoGitHub(produtos);
      renderProdutos();
      try {
        const box = document.getElementById("alertBox");
        box.innerHTML = "üóëÔ∏è Produto exclu√≠do com sucesso!";
        box.classList.add("success");
        box.style.display = "block";
        setTimeout(()=> box.style.display="none", 3000);
      } catch(_) {}
    }

    function editarProduto(index){
      const produto = produtos[index];
      if(!produto) return;
      document.getElementById('editId').value = produto.id;
      document.getElementById('editTitulo').value = produto.title;
      document.getElementById('editValor').value = produto.price;
      document.getElementById('editDescricao').value = produto.description;
      document.getElementById('editDepartamento').value = (produto.department || (produto.category==='supplements' || produto.category==='cosmetics' ? produto.category : 'supplements'));
      document.getElementById('editSubcategoria').dataset.value = (produto.category && produto.category !== 'supplements' && produto.category !== 'cosmetics') ? produto.category : '';
      onEditDepartamentoChange();
      document.getElementById('editEstoque').value = produto.stock;
      document.getElementById('editPreview').innerHTML = (produto.gallery || []).map((g,i)=>`<img src="${g}" style="width:80px;height:80px;object-fit:cover;border-radius:6px">`).join('');
      document.getElementById('editModal').classList.add('show'); document.body.classList.add('modal-open');
      document.getElementById('formEditarProduto').onsubmit = async (e)=>{
        e.preventDefault();
        produto.title = document.getElementById('editTitulo').value;
        produto.price = Number(document.getElementById('editValor').value || 0);
        produto.description = document.getElementById('editDescricao').value;
        produto.department = document.getElementById('editDepartamento').value;
        produto.category = document.getElementById('editSubcategoria').value;
        produto.stock = parseInt(document.getElementById('editEstoque').value || '0');
        const fotosInput = document.getElementById('editFotos');
        if(fotosInput.files.length>0){
          const newGallery = await uploadImagens(produto.id, fotosInput.files);
          const cleaned = (newGallery || []).filter(Boolean).filter((u, idx, arr) => arr.indexOf(u) === idx);
          produto.image = cleaned[0] || produto.image;
          produto.gallery = cleaned.slice(1);
        }
        await salvarNoGitHub(produtos);
        renderProdutos();
        document.getElementById('editModal').classList.remove('show'); document.body.classList.remove('modal-open');
      };
    }
</script>
<!-- GitHub Config Modal -->
<div class="modal" id="githubModal">
<div class="modal-content">
<button id="closeGithubModal" style="position:absolute; top:10px; right:10px; background:#ff3c00; border:none; color:#fff; padding:6px 12px; border-radius:6px; cursor:pointer;">X</button>
<h2 style="margin-bottom:14px; color:#ff3c00;">Configura√ß√£o GitHub</h2>
<label>Repository (owner/repo)</label>
<input id="ghRepo" placeholder="ex: usuario/repositorio" style="width:100%; margin-bottom:10px;" type="text"/>
<label>Branch</label>
<input id="ghBranch" placeholder="main" style="width:100%; margin-bottom:10px;" type="text"/>
<label>File Path</label>
<input id="ghPath" placeholder="products.json" style="width:100%; margin-bottom:10px;" type="text"/>
<label>Personal Access Token</label>
<input id="ghToken" placeholder="ghp_xxx" style="width:100%; margin-bottom:16px;" type="password"/>
<div style="display:flex; gap:10px; justify-content:flex-end;">
<button id="saveGithubConfig">Salvar</button>
<button id="testGithubConfig">Testar conex√£o</button>
</div>
<div id="ghAlert" style="margin-top:10px; display:none; padding:8px; border-radius:6px; text-align:center;"></div>
</div>
</div>
<script>
window.onload = function(){
  const ghModal = document.getElementById('githubModal');
  const openBtn = document.getElementById('openGithubModal');
  const closeBtn = document.getElementById('closeGithubModal');
  const saveBtn = document.getElementById('saveGithubConfig');
  const testBtn = document.getElementById('testGithubConfig');

  function showGhAlert(msg, success){
    const el = document.getElementById('ghAlert');
    el.textContent = msg;
    el.style.display = 'block';
    el.style.background = success ? '#28a745' : '#c0392b';
  }

  function loadGithubConfig(){
    const cfg = JSON.parse(localStorage.getItem('ghConfig')||'{}');
    if(cfg.repo) document.getElementById('ghRepo').value = cfg.repo;
    if(cfg.branch) document.getElementById('ghBranch').value = cfg.branch;
    if(cfg.path) document.getElementById('ghPath').value = cfg.path;
    if(cfg.token) document.getElementById('ghToken').value = cfg.token;
  }

  function saveGithubConfig(){
    const cfg = {
      repo: document.getElementById('ghRepo').value,
      branch: document.getElementById('ghBranch').value,
      path: document.getElementById('ghPath').value,
      token: document.getElementById('ghToken').value
    };
    localStorage.setItem('ghConfig', JSON.stringify(cfg));
    showGhAlert('Configura√ß√£o salva!', true);
  }

  async function testGithubConfig(){
    const cfg = JSON.parse(localStorage.getItem('ghConfig')||'{}');
    if(!cfg.repo || !cfg.branch || !cfg.path || !cfg.token){ showGhAlert('Preencha todos os campos antes de testar.', false); return; }
    try{
      const res = await fetch(`https://api.github.com/repos/${cfg.repo}/contents/${cfg.path}?ref=${cfg.branch}`, {
        headers: { Authorization: `token ${cfg.token}` }
      });
      if(res.ok){
        showGhAlert('‚úÖ Conex√£o bem-sucedida!', true);
      } else {
        showGhAlert('‚ùå Erro: ' + res.status, false);
      }
    }catch(e){ showGhAlert('‚ùå Falha: ' + e.message, false); }
  }

  if(openBtn){ openBtn.onclick = ()=>{ loadGithubConfig(); ghModal.style.display='flex'; carregarProdutosGitHub(); }; }
  if(closeBtn){ closeBtn.onclick = ()=>{ ghModal.style.display='none'; carregarProdutosGitHub(); }; }
  if(saveBtn){ saveBtn.onclick = saveGithubConfig; }
  if(testBtn){ testBtn.onclick = testGithubConfig; }
  carregarProdutosGitHub();
};
</script>
<div class="modal" id="editModal">
<div class="modal-content">
<button id="closeEditModal" style="position:absolute; top:10px; right:10px; background:#ff3c00; border:none; color:#fff; padding:6px 12px; border-radius:6px; cursor:pointer;">X</button>
<h2 style="margin-bottom:14px; color:#ff3c00;">Editar Produto</h2>
<form class="form" id="formEditarProduto">
<input id="editId" type="hidden"/>
<input id="editTitulo" placeholder="T√≠tulo do produto" required type="text"/>
<input id="editValor" placeholder="Valor (‚Ç¨)" required step="0.01" type="number"/>
<textarea id="editDescricao" placeholder="Descri√ß√£o do produto"></textarea>
<label>Departamento</label>
<select id="editDepartamento" required>
  <option value="supplements">Supplements</option>
  <option value="cosmetics">Cosmetics</option>
</select>
<label>Categoria</label>
<select id="editSubcategoria" required>
  <option value="">Selecione...</option>
</select>
<label>Estoque</label>
<input id="editEstoque" min="0" placeholder="Quantidade em estoque" type="number"/>
<label class="upload-btn" for="editFotos">üì∑ Alterar Imagens</label>
<input accept="image/*" id="editFotos" multiple type="file"/>
<div class="preview-container" id="editPreview"></div>
<button type="submit">Salvar Altera√ß√µes</button>
</form>
</div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function(){
  var editModal = document.getElementById('editModal');
  if(!editModal) return;
  var closeBtn = document.getElementById('closeEditModal');

  function closeEdit() {
    editModal.classList.remove('show');
    document.body.classList.remove('modal-open');
  }

  if (closeBtn) {
    closeBtn.addEventListener('click', closeEdit);
  }

  // Fechar clicando fora do conte√∫do
  editModal.addEventListener('click', function(e){
    if (e.target === editModal) closeEdit();
  });

  // Fechar com ESC
  document.addEventListener('keydown', function(e){
    if (e.key === 'Escape' && editModal.classList.contains('show')) closeEdit();
  });
});
</script></body>
</html>
